# Mantainer: jonathan.nerat@gmail.com
_pkgname=nnn
pkgname=nnn-git
pkgver=v3.4.r93.1c4bc31
pkgrel=1
pkgdesc='git build of nnn patched for double-sized Nerd Fonts icon support'
arch=('i686' 'x86_64')
url='https://github.com/jarun/nnn'
licence=('BSD')
makedepends=('gcc' 'make')
provides=('nnn')
conflicts=('nnn' 'nnn-git' 'nnn-icons')
source=('git+https://github.com/jarun/nnn.git')
sha256sums=('SKIP')

pkgver() {
	cd "$srcdir/$_pkgname"
	printf "%s" "$(git describe --long --tags | sed 's/\([^-]*-\)g/r\1/;s/-/./g')"
}

prepare() {
	cd "$srcdir/$_pkgname"
	# add a space after every nerdfont icon
	sed -i -E 's:(#define ICON.*?)"(.*)":\1"\2 ":' src/icons-nerdfont.h
}

build() {
	make O_NERD=1 -C "$srcdir/$_pkgname"
}

package() {
	cd "$srcdir/$_pkgname"
	mkdir -p "$pkgdir/usr"
	make PREFIX="$pkgdir/usr" install
}
